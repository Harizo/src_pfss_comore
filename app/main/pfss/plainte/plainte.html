<div id="forms" class="page-layout simple fullwidth doc-page" layout="column">
    <div class="header md-accent-bg" layout="row" layout-align="space-between">
        <div layout="column" layout-align="space-between">
            <div class="breadcrumb" layout="row" layout-align="start center">
                <md-icon md-font-icon="icon-home" class="s16"></md-icon>
                <md-icon md-font-icon="icon-chevron-right" class="s16 separator"></md-icon>
                <span class="parent" Plaintes></span>
            </div>
            <div class="title">Plaintes</div>
        </div>
    </div>
    <div class="content"layout="column">
		<div class="form-wrapper"> 
			<div style="clear:both"></div>
			<div>
				<md-progress-circular ng-if="vm.affiche_load" class="md-accent" aria-label="Rating" md-mode="indeterminate" md-diameter="64"></md-progress-circular> 
				<div ng-if="vm.affiche_load" style="position:relative;top: -30px;  left: 60px;color: #039be5">
					Chargement,veuillez patienter s'il vous plait ...
				</div>
				<div style="widht:100%;">    
					  <md-button type="submit" class="md-raised md-accent" aria-label="Enregistrer"
						  ng-if="!vm.affichage_masque" ng-disabled="filtrepardateform.$invalid||vm.affiche_load" ng-click="vm.filtrer(vm.filtre)">
						  Actualiser
					  </md-button>
					<md-button type="submit" ng-if="!vm.affichage_masque" ng-show="(vm.filtre.id_ile)&&(vm.filtre.id_region)&&(vm.filtre.id_commune)&&(vm.filtre.village_id)" class="md-raised md-green-800-bg" aria-label="Nouveau" ng-click="vm.ajouterPlainte()" style="width:10%;">
					  Nouveau
					</md-button>
					<md-button type="submit" ng-if="!vm.affichage_masque" ng-show="(vm.selectedPlainteItem.id)" class="md-raised md-blue-800-bg" aria-label="Modifier" ng-click="vm.modifierPlainte()" style="width:10%;">
					  Modifier
					</md-button>
					<md-button type="submit"  ng-if="!vm.affichage_masque" ng-show="(vm.selectedPlainteItem.id)" class="md-raised md-blue-800-bg" aria-label="Modifier" ng-click="vm.sauverPlainte(vm.saisie,1)" style="width:10%;">
					  Supprimer
					</md-button>
					<md-button class="md-fab md-mini " ng-if="!vm.serveur_central" ng-show="(vm.selectedPlainteItem.id)" aria-label="Use Android" ng-if="!vm.serveur_central" ng-click="vm.envoie_menage()">
					  <md-icon md-svg-src="assets/icons/svg/send.svg" style="color: greenyellow;"></md-icon>
					</md-button>
				  
				</div>
				<form name="filtrepardateform" class="md-inline-form" novalidate >
					<div layout="column" layout-gt-xs="row" flex>

						<md-input-container flex="100" flex-gt-xs="90">
						  <label>Île</label>
							<md-select ng-model="vm.filtre.id_ile" name="ile" ng-change="vm.filtre_region()" required>
							 
							  <md-option ng-repeat="ile in vm.all_ile" value="{{ile.id}}" >
								{{ile.Ile}}
							  </md-option>

							</md-select>
							<div ng-messages="filtrepardateform.ile.$error"
							  role="alert">
							  <div ng-message="required">
								<span>Île obligatoire</span>
							  </div>
							</div>
						</md-input-container>

						<md-input-container flex="100" flex-gt-xs="90">
						  <label>Région</label>
							<md-select ng-model="vm.filtre.id_region" name="region" ng-change="vm.filtre_commune()" ng-disabled="!vm.filtre.id_ile" required>
							  
							  <md-option ng-repeat="region in vm.all_region" value="{{region.id}}" >
								{{region.Region}}
							  </md-option>

							</md-select>
							<div ng-messages="filtrepardateform.region.$error"
							  role="alert">
							  <div ng-message="required">
								<span>Région obligatoire</span>
							  </div>
							</div>
						</md-input-container>

						<md-input-container flex="100" flex-gt-xs="90">
						  <label>Commune</label>
							<md-select ng-model="vm.filtre.id_commune" name="commune" ng-change="vm.filtre_village()" ng-disabled="!vm.filtre.id_region"  required>
							 
							  <md-option ng-repeat="commune in vm.all_commune" value="{{commune.id}}" >
								{{commune.Commune}}
							  </md-option>

							</md-select>
							<div ng-messages="filtrepardateform.commune.$error"
							  role="alert">
							  <div ng-message="required">
								<span>Commune obligatoire</span>
							  </div>
							</div>
						</md-input-container>

						<md-input-container flex="100" flex-gt-xs="90">
						  <label>Village</label>
							<md-select ng-model="vm.filtre.village_id" name="village" ng-disabled="!vm.filtre.id_commune"  >
							  <md-option ng-repeat="village in vm.all_village" value="{{village.id}}" >
								{{village.Village}}
							  </md-option>

							</md-select>
							<div ng-messages="filtrepardateform.village.$error"
							  role="alert">
							  <div ng-message="required">
								<span>Village obligatoire</span>
							  </div>
							</div>
						</md-input-container>
					   
					</div>
				</form>
				<div ng-show="vm.affichage_masque">
					<div layout="column" layout-gt-xs="row" flex>
						<md-input-container>
						  <label>CPS</label>
							<md-select name="cellulederecours_id" ng-model="vm.saisie.cellulederecours_id" ng-change="vm.modifierCPS(vm.saisie)" required style="display: inline-block;" style="width:90px;overflow: hidden;text-overflow: ellipsis;">
							  <md-option value=''>&nbsp;</md-option>
							  <md-option ng-repeat="cp in vm.allProtection_sociale" value="{{cp.id}}">
								{{cp.Code}}-{{cp.Nom}}
							  </md-option>
							</md-select>
						</md-input-container>   
						<md-input-container>
						  <label>TYpe plainte</label>
							<md-select name="typeplainte_id" ng-model="vm.saisie.typeplainte_id" ng-change="vm.modifierTP(vm.saisie)" required style="display: inline-block;" style="width:90px;overflow: hidden;text-overflow: ellipsis;">
							  <md-option value=''>&nbsp;</md-option>
							  <md-option ng-repeat="tp in vm.all_type_plainte" value="{{tp.id}}">
								{{tp.Code}}-{{tp.TypePlainte}}
							  </md-option>
							</md-select>
						</md-input-container>   
						<md-input-container>
						<span>Date dépot</span>
						</md-input-container>
						<md-datepicker ng-model="vm.saisie.datedepot"   md-placeholder="Entrer date dépot" required style="width:15%">                       
						</md-datepicker>
						<md-input-container flex-gt-sm ng-show="vm.affichage_masque">
							<input type="text"  name="reference" ng-model="vm.saisie.reference"
							placeholder="Plainte N°" ng-init="vm.saisie.reference=''" required>
							<div ng-messages="filtrepardateform.reference.$error"
								role="alert">
								<div ng-message="required">
									<span>Plainte N°</span>
								</div>
							</div>
						</md-input-container>
						<md-input-container flex-gt-sm ng-show="vm.affichage_masque">
							<input type="text"  name="nomplaignant" ng-model="vm.saisie.nomplaignant"
							placeholder="Nom plaignant N°" ng-init="vm.saisie.nomplaignant=''" required>
							<div ng-messages="filtrepardateform.nomplaignant.$error"
								role="alert">
								<div ng-message="required">
									<span>Nom Plaignant</span>
								</div>
							</div>
						</md-input-container>
						<md-input-container flex-gt-sm ng-show="vm.affichage_masque">
							<input type="text"  name="adresseplaignant" ng-model="vm.saisie.adresseplaignant"
							placeholder="Adresse plaignant" ng-init="vm.saisie.adresseplaignant=''" required>
							<div ng-messages="filtrepardateform.adresseplaignant.$error"
								role="alert">
								<div ng-message="required">
									<span>Adresse Plaignant</span>
								</div>
							</div>
						</md-input-container>
					</div>
					<div layout="column" layout-gt-xs="row" flex>
						<md-input-container flex-gt-sm ng-show="vm.affichage_masque">
							<input type="text"  name="Objet" ng-model="vm.saisie.Objet"
							placeholder="Objet" ng-init="vm.saisie.Objet=''" required>
							<div ng-messages="filtrepardateform.Objet.$error"
								role="alert">
								<div ng-message="required">
									<span>Objet</span>
								</div>
							</div>
						</md-input-container>
					</div>
					<div layout="column" layout-gt-xs="row" flex>
						<md-input-container flex-gt-sm ng-show="vm.affichage_masque">
							<input type="text"  name="responsableenregistrement" ng-model="vm.saisie.responsableenregistrement"
							placeholder="Responsable enregistrement" ng-init="vm.saisie.responsableenregistrement=''" required>
							<div ng-messages="filtrepardateform.responsableenregistrement.$error"
								role="alert">
								<div ng-message="required">
									<span>Responsable enregistrement</span>
								</div>
							</div>
						</md-input-container>
						<md-input-container flex-gt-sm ng-show="vm.affichage_masque">
							<input type="text"  name="mesureprise" ng-model="vm.saisie.mesureprise"
							placeholder="Mesure prise" ng-init="vm.saisie.mesureprise=''" required>
							<div ng-messages="filtrepardateform.mesureprise.$error"
								role="alert">
								<div ng-message="required">
									<span>Mesure prise</span>
								</div>
							</div>
						</md-input-container>
						<md-input-container>
						<span>Date résolution</span>
						</md-input-container>
						<md-datepicker ng-model="vm.saisie.dateresolution"   md-placeholder="Entrer date résoltution" required style="width:15%">                       
						</md-datepicker>
						<md-input-container>
						  <label>Statut</label>
							<md-select name="solution_id" ng-model="vm.saisie.solution_id" ng-change="vm.modifierSOLUTION(vm.saisie)" required style="display: inline-block;" style="width:15%;overflow: hidden;text-overflow: ellipsis;">
							  <md-option value=''>&nbsp;</md-option>
							  <md-option ng-repeat="rp in vm.all_resultat_plainte" value="{{rp.id}}">
								{{rp.code}}-{{rp.libelle}}
							  </md-option>
							</md-select>
						</md-input-container>   
					</div>
					<div>
					 

					<section layout="row" layout-sm="column" layout-align="left" layout-wrap>
			 
					  <md-button type="submit" class="md-raised md-accent" aria-label="Enregistrer"
						  ng-if="vm.affichage_masque" ng-disabled="(filtrepardateform.$invalid)||(vm.disable_button)" ng-click="vm.sauverPlainte(vm.saisie,0)">
						  Enregistrer
					  </md-button>
					  <md-button type="submit" class="md-raised md-primary" aria-label="Enregistrer"
						  ng-if="vm.affichage_masque"  ng-click="vm.annulerPlainte()">
						  Annuler
					  </md-button>
					  
					</section>

				 
					</div>
				</div>
				
			</div>
			<md-tabs md-dynamic-height ng-show="!vm.affichage_masque">
				<!-- Début affichage liste plainte-->
				<md-tab label="Liste plaintes">
					<md-tab-body>
						<fieldset>
							<legend>
								Plaintes
							</legend>
							<div style="clear:both;"></div>
							<table ng-table="tablePlainte" class="dataTable row-border hover"  datatable="ng" dt-options="vm.dtOptions">
								<thead>
									<tr>
										<th class="secondary-text" ng-repeat="c in :: vm.col_plainte">
											<div class="table-header">
												<span class="column-title">{{c.titre}}</span>
											</div>
										</th>
									</tr>
								</thead>
								<tbody>
									<tr  ng-repeat="pl in vm.allPlainte"  ng-class="{selected: pl.$selected}" ng-click="vm.selectionPlainte(pl)">
										<td>{{pl.village}}</td>
										<td>{{pl.code}}</td>
										<td>{{pl.type_plainte}}</td>
										<td>{{pl.resultat_plainte}}</td>
										<td>{{pl.Objet}}</td>
										<td>{{pl.datedepot}}</td>
										<td>{{pl.reference}}</td>
										<td>{{pl.nomplaignant}}</td>
										<td>{{pl.adresseplaignant}}</td>
										<td>{{pl.dateresolution}}</td>
									</tr>
								</tbody>
							</table>
						</fieldset>
					</md-tab-body>
				</md-tab> 
				<!-- Fin affichage liste plainte-->
			</md-tabs>
		</div>
    </div>
</div>
    


